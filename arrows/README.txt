Based on 'Arrows and Computation' by Ross Paterson
