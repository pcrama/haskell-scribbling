#+TITLE: A Play On Regular Expressions

* Introduction

Follow the functional pearl "A Play on Regular Expressions" by Sebastian Fischer
Frank Huch and Thomas Wilke.

* Runtime comparison of functional pearl vs grep
On a tablet inside a chroot ~uname -a~ with ~ghc --version~:
: Linux localhost 3.18.14-15260192 #1 SMP PREEMPT Tue Mar 31 19:26:30 KST 2020 armv8l GNU/Linux
: The Glorious Glasgow Haskell Compilation System, version 8.4.4

Unfortunately, I can't replicate the results of the functional pearl (unless
their machine was way more powerful than mine): the Haskell program runs
slower than grep even for large numbers (trying with 1400 crashes the Linux
chroot).

** Haskell
*** Command Line
#+begin_src shell :exports code
  GENRND=$HOME/haskell-scribbling/APlayOnRegularExpressions/dist-newstyle/build/arm-linux/ghc-8.4.4/APlayOnRegularExpressions-0.1.0.0/x/genrnd/build/genrnd/genrnd
  MATCH=$HOME/haskell-scribbling/APlayOnRegularExpressions/dist-newstyle/build/arm-linux/ghc-8.4.4/APlayOnRegularExpressions-0.1.0.0/x/match/build/match/match
  for x in 5 10 100 200 300 400 500 600 700 800 900 1000 ; do echo $x ; time $GENRND -aa $x | $MATCH a$x ; done
#+end_src

*** Results
|    n | real [s] | user [s] | sys [s] |
|    5 |    0.037 |    0.000 |   0.010 |
|   10 |    0.041 |    0.000 |   0.000 |
|  100 |    0.279 |    0.220 |   0.020 |
|  200 |    1.187 |    1.140 |   0.030 |
|  300 |    2.696 |    2.590 |   0.060 |
|  400 |    5.160 |    4.990 |   0.100 |
|  500 |    9.220 |    8.380 |   0.710 |
|  600 |   12.443 |   12.020 |   0.290 |
|  700 |   18.230 |   17.510 |   0.540 |
|  800 |   23.142 |   22.300 |   0.610 |
|  900 |   31.869 |   30.750 |   0.770 |
| 1000 |   37.059 |   35.820 |   0.860 |

** Grep
*** Command Line
#+begin_src shell :exports code
  GENRND=$HOME/haskell-scribbling/APlayOnRegularExpressions/dist-newstyle/build/arm-linux/ghc-8.4.4/APlayOnRegularExpressions-0.1.0.0/x/genrnd/build/genrnd/genrnd
  for x in 5 10 100 200 300 400 500 600 700 800 900 1000 ; do echo $x ; time $GENRND -aa $x | grep -cE "^(a?){$x}a{$x}\$" ; done
#+end_src

*** Results
|    n | real [s] | user [s] | sys [s] |
|    5 |    0.067 |    0.000 |   0.010 |
|   10 |    0.039 |    0.000 |   0.000 |
|  100 |    0.061 |    0.020 |   0.010 |
|  200 |    0.224 |    0.190 |   0.000 |
|  300 |    0.622 |    0.570 |   0.010 |
|  400 |    1.394 |    1.290 |   0.070 |
|  500 |    2.606 |    2.540 |   0.030 |
|  600 |    4.467 |    4.330 |   0.080 |
|  700 |    6.996 |    6.840 |   0.090 |
|  700 |    7.016 |    6.840 |   0.100 |
|  800 |   10.416 |   10.260 |   0.100 |
|  800 |   10.399 |   10.240 |   0.080 |
|  900 |   14.674 |   14.480 |   0.130 |
|  900 |   14.701 |   14.490 |   0.140 |
| 1000 |   20.128 |   19.900 |   0.150 |
| 1000 |   20.064 |   19.930 |   0.080 |
| 1100 |   26.816 |   26.470 |   0.220 |
| 1200 |   34.541 |   34.290 |   0.160 |
| 1300 |   43.996 |   43.570 |   0.240 |
| 1400 |   54.843 |   54.360 |   0.290 |
| 1500 |   67.553 |   67.060 |   0.390 |
| 1700 |   97.993 |   97.500 |   0.390 |
| 1800 |  115.993 |  115.380 |   0.500 |
